<!DOCTYPE html>
<html>
<head>
  <script>
    async function generateEmail() {
      const full = document.getElementById("fullname").value.trim();
      const result = document.getElementById("result");
      const copyBtn = document.getElementById("copyBtn");

      if (!full) {
        result.value = "Enter full name";
        copyBtn.style.display = "none";
        return;
      }

      const parts = full.split(/\s+/);
      const first = parts[0] || "";
      const last = parts.slice(1).join(" ") || "";

      result.value = "Generating...";
      copyBtn.style.display = "none";

      try {
        const response = await fetch("https://misty-dew-0e2a.ottoberserk.workers.dev/", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ firstName: first, lastName: last })
        });

        const data = await response.json();
        if (data.alias) {
          result.value = data.alias;
          copyBtn.style.display = "inline";
        } else {
          result.value = "Error generating alias";
        }
      } catch (err) {
        result.value = "Error: " + err.message;
      }
    }

    function copyAlias() {
      const result = document.getElementById("result");
      result.select();
      document.execCommand("copy");
    }
  </script>
</head>
<body>
  <input type="text" id="fullname" placeholder="Full Name">
  <button onclick="generateEmail()">Generate</button><br><br>
  <input type="text" id="result" readonly placeholder="Generated Email">
  <button id="copyBtn" onclick="copyAlias()" style="display:none;">Copy</button>
</body>
</html>
